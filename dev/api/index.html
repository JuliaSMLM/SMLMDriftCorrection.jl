<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · SMLMDriftCorrection.jl</title><meta name="title" content="API · SMLMDriftCorrection.jl"/><meta property="og:title" content="API · SMLMDriftCorrection.jl"/><meta property="twitter:title" content="API · SMLMDriftCorrection.jl"/><meta name="description" content="Documentation for SMLMDriftCorrection.jl."/><meta property="og:description" content="Documentation for SMLMDriftCorrection.jl."/><meta property="twitter:description" content="Documentation for SMLMDriftCorrection.jl."/><meta property="og:url" content="https://JuliaSMLM.github.io/SMLMDriftCorrection.jl/api/"/><meta property="twitter:url" content="https://JuliaSMLM.github.io/SMLMDriftCorrection.jl/api/"/><link rel="canonical" href="https://JuliaSMLM.github.io/SMLMDriftCorrection.jl/api/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SMLMDriftCorrection.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../configuration/">Configuration</a></li><li><a class="tocitem" href="../theory_workflow/">Theory &amp; Workflow</a></li><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li><a class="tocitem" href="#Main-Interface"><span>Main Interface</span></a></li><li><a class="tocitem" href="#Utility-Functions"><span>Utility Functions</span></a></li><li><a class="tocitem" href="#Drift-Models"><span>Drift Models</span></a></li><li><a class="tocitem" href="#Drift-Application"><span>Drift Application</span></a></li><li><a class="tocitem" href="#Entropy-Functions"><span>Entropy Functions</span></a></li><li><a class="tocitem" href="#Cross-Correlation"><span>Cross-Correlation</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaSMLM/SMLMDriftCorrection.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaSMLM/SMLMDriftCorrection.jl/blob/main/docs/src/api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API-Reference"><a class="docs-heading-anchor" href="#API-Reference">API Reference</a><a id="API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-Reference" title="Permalink"></a></h1><ul><li><a href="#SMLMDriftCorrection.IntraLegendre"><code>SMLMDriftCorrection.IntraLegendre</code></a></li><li><a href="#SMLMDriftCorrection.LegendrePoly1D"><code>SMLMDriftCorrection.LegendrePoly1D</code></a></li><li><a href="#SMLMDriftCorrection.LegendrePolynomial"><code>SMLMDriftCorrection.LegendrePolynomial</code></a></li><li><a href="#SMLMDriftCorrection.applydrift"><code>SMLMDriftCorrection.applydrift</code></a></li><li><a href="#SMLMDriftCorrection.correctdrift"><code>SMLMDriftCorrection.correctdrift</code></a></li><li><a href="#SMLMDriftCorrection.crosscorr2D"><code>SMLMDriftCorrection.crosscorr2D</code></a></li><li><a href="#SMLMDriftCorrection.drift_trajectory"><code>SMLMDriftCorrection.drift_trajectory</code></a></li><li><a href="#SMLMDriftCorrection.driftcorrect"><code>SMLMDriftCorrection.driftcorrect</code></a></li><li><a href="#SMLMDriftCorrection.entropy_HD"><code>SMLMDriftCorrection.entropy_HD</code></a></li><li><a href="#SMLMDriftCorrection.filter_emitters"><code>SMLMDriftCorrection.filter_emitters</code></a></li><li><a href="#SMLMDriftCorrection.findshift"><code>SMLMDriftCorrection.findshift</code></a></li><li><a href="#SMLMDriftCorrection.histimage2D"><code>SMLMDriftCorrection.histimage2D</code></a></li><li><a href="#SMLMDriftCorrection.ub_entropy"><code>SMLMDriftCorrection.ub_entropy</code></a></li><li><a href="../configuration/#SMLMDriftCorrection.DriftConfig"><code>SMLMDriftCorrection.DriftConfig</code></a></li><li><a href="../configuration/#SMLMDriftCorrection.DriftInfo"><code>SMLMDriftCorrection.DriftInfo</code></a></li></ul><h2 id="Main-Interface"><a class="docs-heading-anchor" href="#Main-Interface">Main Interface</a><a id="Main-Interface-1"></a><a class="docs-heading-anchor-permalink" href="#Main-Interface" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="SMLMDriftCorrection.driftcorrect"><a class="docstring-binding" href="#SMLMDriftCorrection.driftcorrect"><code>SMLMDriftCorrection.driftcorrect</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">driftcorrect(smld; kwargs...) -&gt; (corrected_smld, info)
driftcorrect(smld, config::DriftConfig) -&gt; (corrected_smld, info)</code></pre><p>Main interface for drift correction. Uses Legendre polynomial model with entropy-based cost function and adaptive KDTree neighbor building.</p><p><strong>Arguments</strong></p><ul><li><code>smld</code>: SMLD structure containing (X, Y) or (X, Y, Z) localization coordinates (μm)</li><li><code>config</code>: Optional <code>DriftConfig</code> struct (alternative to keyword arguments)</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>quality=:singlepass</code>: Quality tier (<code>:fft</code>, <code>:singlepass</code>, <code>:iterative</code>)</li><li><code>degree=2</code>: Polynomial degree for intra-dataset drift model</li><li><code>dataset_mode=:registered</code>: Semantic label for multi-dataset handling:<ul><li><code>:registered</code>: datasets are independent acquisitions</li><li><code>:continuous</code>: one long acquisition split into files</li></ul></li><li><code>chunk_frames=0</code>: For continuous mode, split each dataset into chunks of this many frames</li><li><code>n_chunks=0</code>: Alternative to chunk_frames - specify number of chunks per dataset</li><li><code>maxn=200</code>: Maximum number of neighbors for entropy calculation</li><li><code>max_iterations=10</code>: Maximum iterations for <code>:iterative</code> mode</li><li><code>convergence_tol=0.001</code>: Convergence tolerance (μm) for <code>:iterative</code> mode</li><li><code>warm_start=nothing</code>: Previous model for warm starting optimization</li><li><code>verbose=0</code>: Verbosity level (0=quiet, 1=info, 2=debug)</li><li><code>auto_roi=false</code>: Set to <code>true</code> for faster (but slightly less accurate) estimation using a dense ROI subset</li><li><code>σ_loc=0.010</code>: Typical localization precision (μm) for ROI sizing</li><li><code>σ_target=0.001</code>: Target drift precision (μm) for ROI sizing</li><li><code>roi_safety_factor=4.0</code>: Safety multiplier for required localizations</li></ul><p><strong>Quality Tiers</strong></p><ul><li><code>:fft</code>: Fast cross-correlation only (~10x faster, less accurate)</li><li><code>:singlepass</code>: Current algorithm - parallel intra, then sequential inter (default)</li><li><code>:iterative</code>: Full convergence - iterates intra↔inter until shift changes &lt; tol</li></ul><p><strong>Returns</strong></p><p>Tuple <code>(corrected_smld, info)</code> where <code>info::DriftInfo</code> contains:</p><ul><li><code>model</code>: Fitted drift model (LegendrePolynomial)</li><li><code>elapsed_s</code>: Wall time in seconds</li><li><code>backend</code>: Computation backend (<code>:cpu</code>)</li><li><code>iterations</code>: Number of iterations completed</li><li><code>converged</code>: Whether convergence was achieved</li><li><code>entropy</code>: Final entropy value</li><li><code>history</code>: Entropy per iteration (for diagnostics)</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs"># Basic usage
(smld_corrected, info) = driftcorrect(smld)

# Using DriftConfig
config = DriftConfig(; quality=:iterative, degree=3, verbose=1)
(smld_corrected, info) = driftcorrect(smld, config)

# Fast FFT-only mode
(smld_corrected, info) = driftcorrect(smld; quality=:fft)

# Warm start from previous result
(smld1, info1) = driftcorrect(smld1; degree=2)
(smld2, info2) = driftcorrect(smld2; warm_start=info1.model)

# Extract drift trajectory for plotting
traj = drift_trajectory(info.model)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMDriftCorrection.jl/blob/b3d2f26ce211dd5b7143a52899606870076fb480/src/interface.jl#L3-L66">source</a></section><section><div><pre><code class="language-julia hljs">driftcorrect(smld, info::DriftInfo; kwargs...) -&gt; (corrected_smld, info)</code></pre><p>Continue drift correction from a previous result using the model from info.</p><p><strong>Keyword Arguments</strong></p><ul><li><code>dataset_mode=:registered</code>: Dataset mode (<code>:registered</code> or <code>:continuous</code>)</li><li><code>max_iterations=10</code>: Additional iterations to run</li><li><code>convergence_tol=0.001</code>: Convergence tolerance (μm)</li><li><code>maxn=200</code>: Maximum neighbors for entropy calculation</li><li><code>verbose=0</code>: Verbosity level</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMDriftCorrection.jl/blob/b3d2f26ce211dd5b7143a52899606870076fb480/src/interface.jl#L185-L196">source</a></section></details></article><p>See <a href="../configuration/#Configuration">Configuration</a> for full documentation of <a href="../configuration/#SMLMDriftCorrection.DriftConfig"><code>DriftConfig</code></a> and <a href="../configuration/#SMLMDriftCorrection.DriftInfo"><code>DriftInfo</code></a>.</p><h2 id="Utility-Functions"><a class="docs-heading-anchor" href="#Utility-Functions">Utility Functions</a><a id="Utility-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Utility-Functions" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="SMLMDriftCorrection.filter_emitters"><a class="docstring-binding" href="#SMLMDriftCorrection.filter_emitters"><code>SMLMDriftCorrection.filter_emitters</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">filter_emitters(smld, keep) -&gt; smld</code></pre><p>Select the emitters indexed by <code>keep</code> from the SMLD structure, returning a new SMLD with only those emitters. <code>keep</code> may be a single positive integer, a range, a vector of integers, or a <code>BitVector</code> mask.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">smld_sub = filter_emitters(smld, [1])
length(smld_sub.emitters)  # 1</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMDriftCorrection.jl/blob/b3d2f26ce211dd5b7143a52899606870076fb480/src/utilities.jl#L1-L13">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SMLMDriftCorrection.drift_trajectory"><a class="docstring-binding" href="#SMLMDriftCorrection.drift_trajectory"><code>SMLMDriftCorrection.drift_trajectory</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">drift_trajectory(model; dataset=nothing, frames=nothing, cumulative=false)</code></pre><p>Extract drift trajectory from a drift model for plotting.</p><p><strong>Arguments</strong></p><ul><li><code>model</code>: Polynomial or LegendrePolynomial drift model</li><li><code>dataset</code>: specific dataset to extract (default: all datasets)</li><li><code>frames</code>: frame range to evaluate (default: 1:n_frames for each dataset)</li><li><code>cumulative</code>: if true, chain datasets end-to-end showing total accumulated drift. Useful for registered acquisitions where you want to visualize what drift would look like without stage registration. Default: false.</li></ul><p><strong>Returns</strong></p><p>NamedTuple with fields ready for plotting:</p><ul><li><code>frames</code>: frame numbers (global if multiple datasets)</li><li><code>x</code>: x-drift values (μm)</li><li><code>y</code>: y-drift values (μm)</li><li><code>z</code>: z-drift values (μm) - only present for 3D models</li><li><code>dataset</code>: dataset index for each point (useful for coloring)</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">result = driftcorrect(smld; dataset_mode=:registered)
traj = drift_trajectory(result.model)  # Each dataset relative to ds1

# Cumulative view - chains datasets end-to-end
traj_cumul = drift_trajectory(result.model; cumulative=true)
plot(traj_cumul.frames, traj_cumul.x, label=&quot;X drift (cumulative)&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMDriftCorrection.jl/blob/b3d2f26ce211dd5b7143a52899606870076fb480/src/utilities.jl#L184-L214">source</a></section></details></article><h2 id="Drift-Models"><a class="docs-heading-anchor" href="#Drift-Models">Drift Models</a><a id="Drift-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Drift-Models" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="SMLMDriftCorrection.LegendrePolynomial"><a class="docstring-binding" href="#SMLMDriftCorrection.LegendrePolynomial"><code>SMLMDriftCorrection.LegendrePolynomial</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">LegendrePolynomial</code></pre><p>Combined intra + inter Legendre drift model. Contains one IntraLegendre per dataset plus inter-dataset shifts. The n_frames field stores the valid frame range for drift evaluation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMDriftCorrection.jl/blob/b3d2f26ce211dd5b7143a52899606870076fb480/src/legendre.jl#L149-L155">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SMLMDriftCorrection.IntraLegendre"><a class="docstring-binding" href="#SMLMDriftCorrection.IntraLegendre"><code>SMLMDriftCorrection.IntraLegendre</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">IntraLegendre</code></pre><p>Intra-dataset Legendre drift model - wraps one LegendrePoly1D per spatial dimension.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMDriftCorrection.jl/blob/b3d2f26ce211dd5b7143a52899606870076fb480/src/legendre.jl#L67-L71">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SMLMDriftCorrection.LegendrePoly1D"><a class="docstring-binding" href="#SMLMDriftCorrection.LegendrePoly1D"><code>SMLMDriftCorrection.LegendrePoly1D</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">LegendrePoly1D</code></pre><p>Univariate Legendre polynomial drift model for a single spatial dimension. Coefficients are for P<em>1(t), P</em>2(t), ..., P_degree(t) where t is normalized to [-1, 1].</p><p>Note: P_0 (constant) is NOT included because the inter-dataset shift already handles global offsets. This matches the convention for standard Polynomial1D which uses t^1, t^2, ... (no constant term).</p><p>The key advantage over standard polynomials: orthogonal basis functions mean each coefficient captures independent variation, leading to better-conditioned optimization.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMDriftCorrection.jl/blob/b3d2f26ce211dd5b7143a52899606870076fb480/src/legendre.jl#L6-L19">source</a></section></details></article><h2 id="Drift-Application"><a class="docs-heading-anchor" href="#Drift-Application">Drift Application</a><a id="Drift-Application-1"></a><a class="docs-heading-anchor-permalink" href="#Drift-Application" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="SMLMDriftCorrection.applydrift"><a class="docstring-binding" href="#SMLMDriftCorrection.applydrift"><code>SMLMDriftCorrection.applydrift</code></a> — <span class="docstring-category">Function</span></summary><section><div><p>Apply drift to coordinate using Legendre polynomial model. Uses P<em>1 through P</em>degree (no constant P_0 term).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMDriftCorrection.jl/blob/b3d2f26ce211dd5b7143a52899606870076fb480/src/legendre.jl#L43-L46">source</a></section><section><div><p>Apply drift to simulated data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMDriftCorrection.jl/blob/b3d2f26ce211dd5b7143a52899606870076fb480/src/intrainter.jl#L15-L17">source</a></section><section><div><p>applydrift(smld, driftmodel) -&gt; smld</p><p>Applies a drift model to SMLM data (for simulation/testing).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMDriftCorrection.jl/blob/b3d2f26ce211dd5b7143a52899606870076fb480/src/intrainter.jl#L49-L53">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SMLMDriftCorrection.correctdrift"><a class="docstring-binding" href="#SMLMDriftCorrection.correctdrift"><code>SMLMDriftCorrection.correctdrift</code></a> — <span class="docstring-category">Function</span></summary><section><div><p>Correct drift from coordinate using Legendre polynomial model. Uses P<em>1 through P</em>degree (no constant P_0 term).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMDriftCorrection.jl/blob/b3d2f26ce211dd5b7143a52899606870076fb480/src/legendre.jl#L55-L58">source</a></section><section><div><p>Apply drift correction to drifted data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMDriftCorrection.jl/blob/b3d2f26ce211dd5b7143a52899606870076fb480/src/intrainter.jl#L22-L24">source</a></section></details></article><h2 id="Entropy-Functions"><a class="docs-heading-anchor" href="#Entropy-Functions">Entropy Functions</a><a id="Entropy-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Entropy-Functions" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="SMLMDriftCorrection.entropy_HD"><a class="docstring-binding" href="#SMLMDriftCorrection.entropy_HD"><code>SMLMDriftCorrection.entropy_HD</code></a> — <span class="docstring-category">Function</span></summary><section><div><p>H_i(D) is the entropy of the distribution p(r), where D = {d(1),...,d(L)} is the drift at all frames (1 to L). The quantity below is Gaussian Mixture Model single components summed over all localizations provided.</p><p>σ<em>x and σ</em>y are localization uncertainties.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMDriftCorrection.jl/blob/b3d2f26ce211dd5b7143a52899606870076fb480/src/cost_entropy.jl#L15-L22">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SMLMDriftCorrection.ub_entropy"><a class="docstring-binding" href="#SMLMDriftCorrection.ub_entropy"><code>SMLMDriftCorrection.ub_entropy</code></a> — <span class="docstring-category">Function</span></summary><section><div><p>Entropy upper bound based on maxn nearest neighbors of each localization (2D).</p><p><strong>Arguments</strong></p><ul><li>x, y: Vectors of localization positions</li><li>σ<em>x, σ</em>y: Vectors of localization uncertainties</li><li>maxn: Maximum number of neighbors considered (default 200)</li><li>divmethod: Divergence method (&quot;KL&quot;, &quot;Symmetric&quot;, &quot;Bhattacharyya&quot;, &quot;Mahalanobis&quot;)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMDriftCorrection.jl/blob/b3d2f26ce211dd5b7143a52899606870076fb480/src/cost_entropy.jl#L295-L303">source</a></section><section><div><p>Entropy upper bound based on maxn nearest neighbors of each localization (3D).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMDriftCorrection.jl/blob/b3d2f26ce211dd5b7143a52899606870076fb480/src/cost_entropy.jl#L331-L333">source</a></section><section><div><p>Matrix interface for ub_entropy - extracts vectors and calls optimized version. Expects r and σ to be N×K matrices (points as rows, dimensions as columns).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMDriftCorrection.jl/blob/b3d2f26ce211dd5b7143a52899606870076fb480/src/cost_entropy.jl#L361-L364">source</a></section></details></article><h2 id="Cross-Correlation"><a class="docs-heading-anchor" href="#Cross-Correlation">Cross-Correlation</a><a id="Cross-Correlation-1"></a><a class="docs-heading-anchor-permalink" href="#Cross-Correlation" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="SMLMDriftCorrection.findshift"><a class="docstring-binding" href="#SMLMDriftCorrection.findshift"><code>SMLMDriftCorrection.findshift</code></a> — <span class="docstring-category">Function</span></summary><section><div><p>Perform a cross-correlation between images representing localizations in two SMLD structures and compute the shift between the two original images. histbinsize is the size of the bins in the histogram image in the same units as the localization coordinates.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMDriftCorrection.jl/blob/b3d2f26ce211dd5b7143a52899606870076fb480/src/crosscorr.jl#L350-L355">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SMLMDriftCorrection.histimage2D"><a class="docstring-binding" href="#SMLMDriftCorrection.histimage2D"><code>SMLMDriftCorrection.histimage2D</code></a> — <span class="docstring-category">Function</span></summary><section><div><p>Produce a histogram image from the localization coordinates x and y. x and y are in arbitrary units. ROI is [x<em>min, x</em>max, y<em>min, y</em>max] of the Region Of Interest in the same units as x and y.  If not provided, these values are estimated from the coordinate data. histbinsize is the size of the bins of each coordinate in the same units.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMDriftCorrection.jl/blob/b3d2f26ce211dd5b7143a52899606870076fb480/src/crosscorr.jl#L158-L165">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SMLMDriftCorrection.crosscorr2D"><a class="docstring-binding" href="#SMLMDriftCorrection.crosscorr2D"><code>SMLMDriftCorrection.crosscorr2D</code></a> — <span class="docstring-category">Function</span></summary><section><div><p>Compute the cross-correlation between two 2D images with zero-padding.</p><p>Zero-padding to 2x size eliminates cyclic wrap-around artifacts that cause false peaks at large shifts.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaSMLM/SMLMDriftCorrection.jl/blob/b3d2f26ce211dd5b7143a52899606870076fb480/src/crosscorr.jl#L287-L292">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theory_workflow/">« Theory &amp; Workflow</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Sunday 15 February 2026 16:35">Sunday 15 February 2026</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
